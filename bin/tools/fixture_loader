#!/usr/bin/env node
var argv = require('optimist').argv,
    configLoader = require("../../app/common/config"),
    fixtures = require('pow-mongodb-fixtures').connect(configLoader.getConnectionString());

// Clear fixtures
if(argv.purge) {
    var config = configLoader.getConfig();
    fixtures.clear(function(err) {
        console.log(err || "data cleared from " + config.db.database);
        process.exit();
    })
}

// Load fixtures
var fixtureDir = argv._[0] || 'default';

fixtures.clearAndLoad("../../test/fixtures/" + fixtureDir, function(err) {
    console.log(err || fixtureDir + " fixtures loaded into " + process.env.NODE_ENV + " database");
    process.exit();
});